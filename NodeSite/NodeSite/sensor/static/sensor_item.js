// Generated by CoffeeScript 1.7.1
'use strict';
$(function() {
  var $realtimeChart, endTime, html, now, sensorEnToCn, sid, source, startTime, template;
  console.log("here is sensor item");
  sid = window.location.pathname.split("/")[2];
  $realtimeChart = $("#realtime-chart");
  sensorEnToCn = {
    "temperature": "温度",
    "co2": "二氧化碳",
    "humidity": "湿度"
  };
  now = new Date();
  endTime = now.getTime();
  startTime = new Date(endTime - 3600000);
  endTime = now;
  getDataFromS({
    url: "/data/sensor/" + sid + "/",
    requestData: {
      startTime: "2014/03/27 00:00:00",
      endTime: "2014/03/30 23:59:58"
    },
    callback: function(data) {
      var datapkg, html, key, _results;
      if (data.code === -1) {
        $realtimeChart.html("<p class=error>目前还没有数据</p>");
        return 0;
      }
      datapkg = dataPkgForD3(data.body);
      console.log(datapkg);
      html = renderRTChart(datapkg);
      $realtimeChart.append(html);
      _results = [];
      for (key in datapkg) {
        data = datapkg[key];
        _results.push(drawLineWithFocusChart({
          elt: "#" + key + " svg",
          data: data,
          xLabel: key,
          yLabel: "采集值"
        }));
      }
      return _results;
    }
  });
  source = $('#download-form-template').html();
  template = Handlebars.compile(source);
  html = template({
    sensorId: sid
  });
  $('#download-area').append(html);
});
